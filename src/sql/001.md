
```
-- create
CREATE TABLE CUSTOMERS (
  custId INTEGER PRIMARY KEY,
  name TEXT NOT NULL,
  city TEXT NOT NULL
);

CREATE TABLE ORDERS (
  ordId INTEGER PRIMARY KEY,
  custId INTEGER NOT NULL references CUSTOMERS(custId),
  item TEXT NOT NULL,
  amount FLOAT NOT NULL,
  orderDate DATETIME NOT NULL
);

-- insert
INSERT INTO CUSTOMERS VALUES (0001, 'Clark Kent', 'Metropolis');
INSERT INTO CUSTOMERS VALUES (0002, 'Bruce Wayne', 'Gotham');
INSERT INTO CUSTOMERS VALUES (0004, 'Barry Allen', 'Starling City');
INSERT INTO CUSTOMERS VALUES (0003, 'Oliver Queen', 'Star City');


INSERT INTO ORDERS VALUES (0001, 0001, 'Cape',100,'2023-01-15 10:10:00');
INSERT INTO ORDERS VALUES (0002, 0001, 'Cowl',100,'2023-01-15 10:10:00');
INSERT INTO ORDERS VALUES (0003, 0001, 'Cryptonite',100,'2023-03-15 10:10:00');
INSERT INTO ORDERS VALUES (0004, 0002, 'Cape',500,'2020-04-15 10:10:00');
INSERT INTO ORDERS VALUES (0005, 0002, 'Cowl',400,'2020-04-15 10:10:00');
INSERT INTO ORDERS VALUES (0006, 0002, 'Batmobile',10000000,'2021-01-01 11:11:01');
INSERT INTO ORDERS VALUES (0007, 0003, 'Cape',500,'2021-04-15 10:10:00');
INSERT INTO ORDERS VALUES (0008, 0003, 'Cowl',400,'2021-04-15 10:10:00');
INSERT INTO ORDERS VALUES (0009, 0003, 'Speed',1000,'2021-01-01 11:11:01');
INSERT INTO ORDERS VALUES (0010, 0004, 'Cape',500,'2021-04-15 10:10:00');
INSERT INTO ORDERS VALUES (0011, 0004, 'Cowl',500,'2021-04-15 10:10:00');
INSERT INTO ORDERS VALUES (0012, 0004, 'Arrows',10000000,'2021-01-01 11:11:01');


-- select * from CUSTOMERS;
-- select * from ORDERS;

-- Select order with the third higest unique amount along with the name and city of the customer
-- Expexted Results:
-- | Bruce Wayne  | Gotham        | Cape |    500 | 2020-04-15 10:10:00 |
-- | Oliver Queen | Star City     | Cape |    500 | 2021-04-15 10:10:00 |
-- | Barry Allen  | Starling City | Cape |    500 | 2021-04-15 10:10:00 |
-- | Barry Allen  | Starling City | Cowl |    500 | 2021-04-15 10:10:00 |


SELECT c.name, c.city, o.item, o.amount, o.orderDate
FROM ORDERS o
JOIN CUSTOMERS c ON o.custId = c.custId
WHERE o.amount = (
  SELECT DISTINCT amount
  FROM ORDERS
  ORDER BY amount DESC
  LIMIT 1 OFFSET 2
); 


-- Show monthly sales amount

-- Expected Results
-- | 2023-01                        |         200 |
-- | 2023-03                        |         100 |
-- | 2020-04                        |         900 |
-- | 2021-01                        |    20001000 |
-- | 2021-04                        |        1900 |

SELECT
  DATE_FORMAT(orderDate, '%Y-%m') AS month,
  SUM(amount) AS total_sales
FROM ORDERS
GROUP BY month;
-- ORDER BY month;


```