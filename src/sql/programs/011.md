# Find employees who earn more than their manager (self-join on employees table)


```sql


-- Find employees who earn more than their manager (self-join on employees table)

-- create table
CREATE TABLE employees (
  id INTEGER PRIMARY KEY,
  mgrId INTEGER,
  name TEXT NOT NULL,
  salary INTEGER
);

-- insert sample data
INSERT INTO employees VALUES (1, NULL, 'CEO', 20000);        -- Top boss, no manager
INSERT INTO employees VALUES (2, 1, 'Clark', 15000);         -- Reports to CEO
INSERT INTO employees VALUES (3, 1, 'Dave', 22000);          -- Reports to CEO, earns more than CEO
INSERT INTO employees VALUES (4, 2, 'Ava', 16000);           -- Reports to Clark, earns more than Clark
INSERT INTO employees VALUES (5, 2, 'Champa', 19000);        -- Reports to Clark
INSERT INTO employees VALUES (6, 3, 'John', 18000);          -- Reports to Dave


select * from employees;


SELECT e.id, e.name, e.salary, e2.name AS managerName, e2.salary AS managerSalary
FROM employees e
JOIN employees e2 ON e.mgrId = e2.id
WHERE e.salary > e2.salary;

```


```
Output:

+----+-------+--------+--------+
| id | mgrId | name   | salary |
+----+-------+--------+--------+
|  1 |  NULL | CEO    |  20000 |
|  2 |     1 | Clark  |  15000 |
|  3 |     1 | Dave   |  22000 |
|  4 |     2 | Ava    |  16000 |
|  5 |     2 | Champa |  19000 |
|  6 |     3 | John   |  18000 |
+----+-------+--------+--------+
+----+--------+--------+-------------+---------------+
| id | name   | salary | managerName | managerSalary |
+----+--------+--------+-------------+---------------+
|  3 | Dave   |  22000 | CEO         |         20000 |
|  4 | Ava    |  16000 | Clark       |         15000 |
|  5 | Champa |  19000 | Clark       |         15000 |
+----+--------+--------+-------------+---------------+

```