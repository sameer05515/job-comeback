# Fetch the top 3 most sold products from the sales table.

```sql

-- Fetch the top 3 most sold products from the sales table.

-- create
CREATE TABLE SALES (
  id INTEGER PRIMARY KEY,
  prodName TEXT NOT NULL,
  itemsSold INTEGER
);



-- insert
INSERT INTO SALES VALUES (0001, 'Sony TV', 250);
INSERT INTO SALES VALUES (0002, 'Apple Phone',626);
INSERT INTO SALES VALUES (0003, 'AC', 5627);
INSERT INTO SALES VALUES (0004, 'Condoms',645628);
INSERT INTO SALES VALUES (0005, 'Samsung Phone',626);



-- fetch 
SELECT prodName, itemsSold
FROM SALES
ORDER BY itemsSold DESC
LIMIT 3;


SELECT *
FROM SALES s
JOIN (
   SELECT id
   FROM SALES
   ORDER BY itemsSold DESC
   LIMIT 3
) t ON s.id = t.id;



-- all sales records whose itemsSold rank in the top 3 (so ties like Apple Phone & Samsung Phone with 626 both should be included).

SELECT id, prodName, itemsSold
FROM (
    SELECT id, prodName, itemsSold,
           DENSE_RANK() OVER (ORDER BY itemsSold DESC) AS rnk
    FROM SALES
) t
WHERE rnk <= 3;

```