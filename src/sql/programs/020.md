# List all employees who manage more than 3 people (self-join scenario).

```sql

-- List all employees who manage more than 3 people (self-join scenario).


CREATE TABLE emp_mgr (
  id INT PRIMARY KEY,
  name VARCHAR(50),
  mgrId INT
);

INSERT INTO emp_mgr VALUES
(1, 'CEO', NULL),
(2, 'Manager A', 1),
(3, 'Manager B', 1),
(4, 'Staff 1', 2),
(5, 'Staff 2', 2),
(6, 'Staff 3', 2),
(7, 'Staff 4', 2),
(8, 'Staff 5', 3);


SELECT m.id, m.name, COUNT(e.id) AS reportees
FROM emp_mgr m
JOIN emp_mgr e ON m.id = e.mgrId
GROUP BY m.id, m.name
HAVING COUNT(e.id) > 3;


```